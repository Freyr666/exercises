#!/bin/sh

set -e

OCAMLBUILD=${OCAMLBUILD:="ocamlbuild -classic-display \
                          -use-ocamlfind \
                          -plugin-tag package(js_of_ocaml.ocamlbuild)"}

action ()
{
    case $1 in
        default)
            action app
            ;;
        app)
            shift
            $OCAMLBUILD -no-links local.js 2048.html
            if [ "$1" = "-b" ]; then
                $RELOAD_BROWSER "file://`pwd`/_build/src/2048.html"
            fi
            ;;
        clean)
            $OCAMLBUILD -clean ;;
        *)
            $OCAMLBUILD $* ;;
    esac
}

if [ $# -eq 0 ];
then action default ;
else action $*; fi
